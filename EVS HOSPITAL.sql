
-------------------CREATED DATABASE-------------------------
CREATE DATABASE EVS_HOSPITAL
USE EVS_HOSPITAL;
 ------------------CREATED TABLES---------------------------
CREATE TABLE PATIENT(
PATIENT_ID    INT PRIMARY KEY NOT NULL,
PATIENT_FIRSTNAME VARCHAR (50),
PATIENT_LASTNAME VARCHAR (50),
GENDER VARCHAR (10),
DATEOFBIRTH VARCHAR(50),
AGE FLOAT(10),
ADDRESS VARCHAR (50),
PHONENUMBER VARCHAR(10),
MAIL_ID VARCHAR(50),
EMERGENCYCONTACTNAME VARCHAR (50),
EMERGENCYCONTACTNUMBER VARCHAR (50),
INSURENCE_ID VARCHAR(10),
INSURENCECOMAPANY VARCHAR (50),
INSURENCETYPE VARCHAR (50),
DEPARTMENT_ID INT NOT NULL,
FOREIGN KEY (DEPARTMENT_ID) 
REFERENCES DEPARTMENT (DEPARTMENT_ID)
);
---------------------------ADD QUARY-----------------------
INSERT INTO PATIENT VALUES('01','ZAINAB','FATHIMA','FEMALE','1.JAN.2000','23','MAIN STREET COLOMBO 2','0786854939','ZAIN@GMAIL.COM','MOHAMMED','09817373829','100','ALLIENCE','HEALTH','1');
INSERT INTO PATIENT VALUES('02','ROCKY','BHAI','MALE','23.DEC.2003','19','MAIN STREET KOLONNAVA 3','0768947593','BHAI@GMAIL.COM','YASH','072904922','120','JANASHAKTHI','HEALTH','2');
INSERT INTO PATIENT VALUES('03','VIJAY','SANJAY','MALE','20.FEB.2001','22','2ND CROSS  STREET COLOMBO 7','0784309300','VJ@GMAIL.COM','KASIM','0764859392','130','ALLIENCE','LIFE','3')
INSERT INTO PATIENT VALUES('04','PRIYA','SHANMUGHAM','FEMALE','30.NOV.1980','43','3RD CROSS STREET BANDARAVALA 6','0768494498','SHANPRI@GMAIL.COM','SHANMUGHAM','0789578940','140','ALLIENCE','DESABILITY','4');
INSERT INTO PATIENT VALUES('05','KIA','ZAAN','FEMALE','20.JAN.2020','3','MAIN STREET KANDY 5','0786985897','KIA@GMAIL.COM','ZAAN','0789567894','150','ALLIENCE','LIFE','5');
INSERT INTO PATIENT VALUES('06','MIANA','ELIZE','FEMALE','2.MAR.2021','2','HILL STREET NUWARAELIYA 6','0768498690','MIANA@GMAIL.COM','ELIZ','0765849302','160','ALLIENCE','DESABILITY','6');
INSERT INTO PATIENT VALUES('07','KIKI','CHANDRU','FEMALE','30.FEB.2001','22','GALLE ROAD COLOMBO 7','0789687959','CHANDRUKIKI@GMAIL.COM','CHANDRU','0789273829','170','ALLIENCE','HEALTH','7');
INSERT INTO PATIENT VALUES('08','ALIYA','ZAID','FEMALE','29.JAN.1990','33','MAIN STREET KATHURUWELA 8','0757465968','ALIYA@GMAIL.COM','ZAID AHAMED','0768392019','180','ALLIENCE','LIFE','8');
INSERT INTO PATIENT VALUES('09','ZAIN','ABDULLAH','MALE','15.JAN.1995','28','2ND CROSS STREET KAMUINAI 9','0723958590','ZAINABDUL@GMAIL.COM','ABDUL','0789401928','190','JANASHAKTHI','HEALTH','9');
INSERT INTO PATIENT VALUES('10','ZUHA','MOHMMED','FEMALE','7.NOV.1971','52','3RD CROSS STREET WELAWAYA 7','0723456789','ZUHA@GMAIL.COM','BAZIM','0789984567','110','ALLIENCE','HEALTH','10');
 SELECT *FROM PATIENT 
  
CREATE TABLE DOCTOR(
DOCTOR_ID    INT  PRIMARY KEY NOT NULL,
DOCTOR_FIRSTNAME VARCHAR (50),
DOCTOR_LASTNAME VARCHAR (50),
GENDER VARCHAR (10),
ADDRESS VARCHAR (50),
PHONENUMBER VARCHAR(10),
MAIL_ID VARCHAR(50),
SPECIALITY VARCHAR (50),
EXPERIENCE VARCHAR (50),
EDUCATION VARCHAR(50),
SCHEDULE VARCHAR (50),
DEPARTMENT_ID INT NOT NULL,
FOREIGN KEY (DEPARTMENT_ID) 
REFERENCES DEPARTMENT (DEPARTMENT_ID)
);

-------------------------------ADD QUARY------------------
INSERT INTO DOCTOR VALUES('01','ANAFA','ANVER','FEMALE','CROSS STREET SAMMANTHURAI 05','0769873575','ANA@GMAIL.COM','CARDIOLOGY PHYSICIAN','7YEARS','MASTER OF SURGERY,MASTER OF CARDIOTHORASIS','MONDAY EVENING','1');
INSERT INTO DOCTOR VALUES('11','ILHAM','ASWER','MALE',' 1ST CROSS STREET KALMUNAI 05','0787890567','ILHAM@GMAIL.COM','NEUROLOGIST','4YEARS','MASTER OF SURGEY,SPECIALIZED IN NEUROLOGY','MONDAY MORNING','2');
INSERT INTO DOCTOR VALUES('12','HAAFIL','MOHAMMED','MALE','2ND CROSS STREET SAINTHAMARUTHU 05','076567890','HAAFIL@GMAIL.COM','ONCOLOGIST','5YEARS','MASTER OF SURGERY,SPECIALIZED IN OSTEOPATHY','TUESDAY EVENING','3');
INSERT INTO DOCTOR VALUES('13','SUBHAN','AHAMED','MALE','4TH CROSS STREET KALMUNAI 04','0778978912','SUBHAN@GMAIL.COM','PEDIATRIC SURGEON','4YEARS','MASTER OF SURGERY','WEDNESDAY EVENING','4');
INSERT INTO DOCTOR VALUES('14','ZEMAAL','MOHAMMED','MALE','MAIN STREET SAINTHAMRUTHU 06','0763456789','ZEMAAL@GMAIL.COM','PEDIATRIC CARDIOLOGIST','5YEARS','MASTER OF SURGEY,MASTER OF CARDIOTHORASIS','MONDAY EVENING','5');
INSERT INTO DOCTOR VALUES('15','SHEIKHA','SHARAFDEEN','FEMALE','MAIN STREET SAINTHAMRUTHU 07','0765789234','SHEIKHA@GMAIL.COM','NEPHROLOGIST','4YEARS','MASTER OF SURGEY,MASTER OF NEPHROLOGY','THURSDAY MORNING','6');
INSERT INTO DOCTOR VALUES('16','THUVARAHA','SHANMUGHAM','FEMALE','2ND CROSS ROAD NEELAVNAI 05','0734560987','THUVA@GMAIL.COM','GENERAL SURGEON','4YEARS','MASTER OF SURGERY','SUNDAY EVENING','7');
INSERT INTO DOCTOR VALUES('17','RATHEEPAN','ANTONY','MALE','MAIN STREET TRINCIMALEE 04','073456709875','RATHEEPAN@GMAIL.COM','GYNOCOLOGIST','3YEARS','MASTER OF SURGEY IN GYNOCOLOGY','SATURDAY EVENING','8');
INSERT INTO DOCTOR VALUES('18','ANAS','AHAMED','MALE','MAIN CROSS STREET SAMMANTHURAI 03','0723456098','ANAS@GMAIL.COM','ORTHOPEDIST','5YEARS','SPECIALIZED IN ORTHOPEDIC','SUNDAY MORNING','9');
INSERT INTO DOCTOR VALUES('19','REHZAN','MOHAMMED','MALE','3RD CROSS STREET AKKARAIPATTU 04','0734587675','REHZAN@GMAIL.COM','ANESTHESIOLOGIST','2YEARS','MASTER OF SURGEY','SUNDAY EVENING','10');
SELECT *FROM DOCTOR
 
CREATE TABLE NURSE(
NURSE_ID    INT  PRIMARY KEY NOT NULL,
NURSE_FIRSTNAME VARCHAR (50),
NURSE_LASTNAME VARCHAR (50),
GENDER VARCHAR (10),
AGE VARCHAR(10),
PHONENUMBER VARCHAR(10),
SHIFT VARCHAR(50),
DEPARTMENT_ID INT NOT NULL,
FOREIGN KEY (DEPARTMENT_ID) 
REFERENCES DEPARTMENT (DEPARTMENT_ID)
);
 -------------------ADD QUARY-------------------
 INSERT INTO NURSE VALUES('100','SAFEEK','SHAN','MALE','45','0786758984','NIGHT','1');
 INSERT INTO NURSE VALUES('101','SATHIK','MOHHAMED','MALE','47','0786574890','NIGHT','2');
 INSERT INTO NURSE VALUES('102','SHAREEN','FATHIMA','FEMALE','43','0768467859','MORNING','3');
 INSERT INTO NURSE VALUES('103','AFRIN','AFRATH','FEMALE','35','0767890557','EVENING','4');
 INSERT INTO NURSE VALUES('104','THOWFEEK','MOHAMMED','MALE','40','0789556093','MORNING','5');
 INSERT INTO NURSE VALUES('105','FERNANDOS','PILLAI','MALE','44','0767894465','MORNING','6');
 INSERT INTO NURSE VALUES('106','ELIZA','MIAKHAN','FEMALE','25','0749029485','NIGHT','7');
 INSERT INTO NURSE VALUES('107','CHAITHU','REDDY','FEMALE','28','0729476057','EVENING','8');
 INSERT INTO NURSE VALUES('108','KHAN','SHEIKH','MALE','40','0756701982','MORNING','9');
 INSERT INTO NURSE VALUES('109','SOUFAK','AHAMED','MALE','26','0767893450','EVENING','10');
 SELECT *FROM NURSE
 
CREATE TABLE STAFF(
STAFF_ID INT  PRIMARY KEY NOT NULL,
STAFF_FIRSTNAME VARCHAR (50),
STAFF_LASTNAME VARCHAR (50),
GENDER VARCHAR (10),
AGE VARCHAR(10),
PHONENUMBER VARCHAR(10),
POSSSITION VARCHAR (50),
DEPARTMENT_ID INT NOT NULL,
FOREIGN KEY (DEPARTMENT_ID) 
REFERENCES DEPARTMENT (DEPARTMENT_ID)
);
-------------------------ADD QUARY------------------
INSERT INTO STAFF VALUES('1000','SHANTHI','SHANMUGHAM','FEMALE','50','0789637890','ASSISTENT','1');
INSERT INTO STAFF VALUES ('1001','SUHAZINI','GOPAL','FEMALE','45','0767899876','FINANCE MANAGER','2');
INSERT INTO STAFF VALUES ('1002','SUZAAN','AHAMED','FEMALE','35','0724569876','LAB TECHNICIAN','3');
INSERT INTO STAFF VALUES ('1003','RAVI','KRISHNAPILLAI','MALE','30','0765679807','ADMINISTRATOR','4');
INSERT INTO STAFF VALUES ('1004','SUHA','MOHAMMED','FEMALE','35','0723456789','RECEPTIONIST','5');
INSERT INTO STAFF VALUES ('1005','ZAIN','KHAN',',MALE','28','0725678943','RECEPTIONIST','6');
INSERT INTO STAFF VALUES ('1006','RIFKA','AHAMMED','FEMALE','25','0756789876','HUMAN RESOURCE PERSON','7');
INSERT INTO STAFF VALUES ('1007','KATHIR','SELVA','MALE','30','0724569876','HUMAN RESOURCE PERSON','8');
INSERT INTO STAFF VALUES ('1008','SELVA','PILLAIMURTHI','MALE','35','0724569875','MAINTANENCE WORKER','9');
INSERT INTO STAFF VALUES ('1009','KARUPPAIYA','SELVARAJ','MALE','50','0763456987','SECURITY PERSON','10');
SELECT *FROM STAFF
 
 
CREATE TABLE DEPARTMENT(
 DEPARTMENT_ID INT PRIMARY KEY NOT NULL,
 DEPARTMENT_NAME VARCHAR (50),
 DEPARTMENT_INCHARGE VARCHAR (50),
 );
 ---------------------ADD QUARY--------------------
INSERT INTO DEPARTMENT VALUES('01','CARDIOLOGY DEPARTMENT','HEMA');
INSERT INTO DEPARTMENT VALUES('02','NEUROLOGY DEPARTMENT','SHEEFA');
INSERT INTO DEPARTMENT VALUES('03','DYALISIS DEPARTMENT','HAMNA');
INSERT INTO DEPARTMENT VALUES('04','GYNOCOLOGY DEPARTMENT','ZAIN');
INSERT INTO DEPARTMENT VALUES('05','ORTHOPEDIC DEPARTMENT','ROHINI');
INSERT INTO DEPARTMENT VALUES('06','PEDIATRIC DEPARTMENT','HEBA');
INSERT INTO DEPARTMENT VALUES('07','NICU DEPARTMENT','SHEABA');
INSERT INTO DEPARTMENT VALUES('08','OPERATION THEATRE','HIFA');
INSERT INTO DEPARTMENT VALUES('09','ICU','BAZEERA'); 
INSERT INTO DEPARTMENT VALUES('10','ADMINISTRATION DEPARTMENT','AMANDA');
SELECT *FROM DEPARTMENT
 
CREATE TABLE APPOINMENT(
APPOINMENT_ID INT  PRIMARY KEY NOT NULL,
APPOINMENTDATE VARCHAR(10),
APPOINMENTTIME FLOAT(50),
APPOINMENTMETHOD VARCHAR (50),
PATIENT_ID INT NOT NULL,
FOREIGN KEY (PATIENT_ID) 
REFERENCES PATIENT (PATIENT_ID),
DOCTOR_ID INT NOT NULL,
FOREIGN KEY (DOCTOR_ID) 
REFERENCES DOCTOR (DOCTOR_ID),
);
 --------------------ADD QUARY----------------
 INSERT INTO APPOINMENT VALUES('01','2023MAY02',16.00,'ONLINE','01','10');
 INSERT INTO APPOINMENT VALUES('02','2023MAY02',16.30,'CALL TO HOSPITAL','02','11');
 INSERT INTO APPOINMENT VALUES('03','2023MAY02',17.00,'ONLINE','03','12');
 INSERT INTO APPOINMENT VALUES('04','2023MAY02',17.30,'ONLINE','04','13');
 INSERT INTO APPOINMENT VALUES('05','2023MAY02',18.00,'CALL TO HOSPITAL','05','14');
 INSERT INTO APPOINMENT VALUES('06','2023MAY02',18.30,'ONLINE','06','15');
 INSERT INTO APPOINMENT VALUES('07','2023MAY02',19.00,'ONLINE','07','16');
 INSERT INTO APPOINMENT VALUES('08','2023MAY02',19.30,'ONLINE','08','17');
 INSERT INTO APPOINMENT VALUES('09','2023MAY02',20.00,'CALL TO HOSPITAL','09','18');
 INSERT INTO APPOINMENT VALUES('10','2023MAY02',20.30,'ONLINE','10','19');
 SELECT * FROM APPOINMENT;
 
CREATE TABLE MEDICALHISTORY(
DIAGNOSIS VARCHAR (50),
TREATMENT VARCHAR (50),
SURGERY VARCHAR (50),
ALLERGIES VARCHAR (50),
MEDICATION VARCHAR (50),
LABTEST VARCHAR (50),
RESULTS VARCHAR(50),
PATIENT_ID INT NOT NULL,
FOREIGN KEY (PATIENT_ID) 
REFERENCES PATIENT (PATIENT_ID),
); 
---------------------ADD QUARY-------------
INSERT INTO MEDICALHISTORY VALUES('ASTHMA','INHALER','NONE','NONE','ALBUTEROL','PULMONARY FUNCTION TEST','FEV1=70%','01');
INSERT INTO MEDICALHISTORY VALUES('OSTEOARTHRITIS','NONSTEROIDAL ANTI-INFLAMMATORY DRUGS','KNEE REPLACEMENT','ASPIRIN','CELECOXIB','XRAY','OSTEOPHYTES OBSERVED','02');
INSERT INTO MEDICALHISTORY VALUES('DEPRESSION','ANTIDEPRESSANTS','NONE','NONE','SERTRALINE','BECK DEPRESSION INVENTORY','SCORE OF 20','03');
INSERT INTO MEDICALHISTORY VALUES('HYPOTHYROIDISM','LEVOTHYROXINE','NONE','NONE','NONE','TSH','TSH 10mlU/L','10');
INSERT INTO MEDICALHISTORY VALUES('CORONARY ARTERY DIDEASE','STATINS','CORONORY ARTRY BYPASS GRAFT','NONE','ATORVASTATIN','ECHOCARDIOGRAM','EJECTION FRACTION REDUCED','04');
INSERT INTO MEDICALHISTORY VALUES('HYPERTENSION','LISINOPRIL','NONE','PENICILINE','ASPIRIN','COMPLETE BLODD COUNT','HEMOGLOBINE 14.5','05');
INSERT INTO MEDICALHISTORY VALUES('TYPE2DIABETES','METFORMIN','NONE','SULFADRUGS','INSULIN','FASTING BLOOD GYLUCOSE','180mg/dL','06');
INSERT INTO MEDICALHISTORY VALUES('MIGRANE','TRIPTANS','NONE','NONE','SUMATRIPTIN','NONE','HEADACHE FREQUENCY REDUCED FOR FEW DAYS','07');
INSERT INTO MEDICALHISTORY VALUES('TYPE2 DIABETES MELLITUS','ORAL HYPOGLESEMIC AGENT','NONE','SULFA DRUGS','METFORMIN','HEAMOGLOBIN A1C','A1C=8.5','08');
INSERT INTO MEDICALHISTORY VALUES('HYPOTHYROIDISM','LEVOTHYROXINE','NONE','ASPIRIN','NONE','TSH','TSH 25mlU/L','09');
SELECT *FROM MEDICALHISTORY


 
CREATE TABLE INVENTORY(
INVENTORY_ID INT PRIMARY KEY NOT NULL,
INVENTORYNAME VARCHAR (50),
QUANTITY VARCHAR (50),
USED VARCHAR (50),
AVAILABILITY VARCHAR (50),
DEPARTMENT_ID INT NOT NULL,
FOREIGN KEY (DEPARTMENT_ID) 
REFERENCES DEPARTMENT (DEPARTMENT_ID)
); 
---------------ADD QUARY-------------
INSERT INTO INVENTORY VALUES ('01','SCALPALES','50','45','LOW','1');
INSERT INTO INVENTORY VALUES ('02','SUTURES','1000','900','LOW','2');
INSERT INTO INVENTORY VALUES ('03','GAUZE PADS','500','400','LOW','3');
INSERT INTO INVENTORY VALUES ('04','OPERATING TABLES','3','2','HIGH','4');
INSERT INTO INVENTORY VALUES ('05','ANESTHESIA MACHINE','2','1','HIGH','5');
INSERT INTO INVENTORY VALUES ('06','SURGICAL DRAPES','200','100','LOW','6');
INSERT INTO INVENTORY VALUES ('07','ELECTROCAUTERY UNITS','4','3','MEDIUM','7');
INSERT INTO INVENTORY VALUES ('08','LAPORASCOPIC INSTRUMENTS','10','8','LOW','8');
INSERT INTO INVENTORY VALUES ('09','ENDOSCOPES','6','4','HIGH','9');
INSERT INTO INVENTORY VALUES ('10','SURGICAL LIGHTS','10','9','LOW','10');
SELECT *FROM INVENTORY

CREATE TABLE BILLING(
BILLING_ID INT PRIMARY KEY NOT NULL,
BILLINGDATE VARCHAR (50),
BILLINGTIME FLOAT (50),
PAYMENTMETHOD VARCHAR (50),
AMOUNT FLOAT (50),
INVENTORYUSAGE VARCHAR (50),
SERVICEPROVIDE VARCHAR(50),
PATIENT_ID INT NOT NULL,
FOREIGN KEY (PATIENT_ID) 
REFERENCES PATIENT (PATIENT_ID)
); 
-------------------ADD QUARY--------------------
INSERT INTO BILLING VALUES('10','2023APRIL05','19.00','CARD','100000','YES','10 DAYS HOSPITALUZED','01');
INSERT INTO BILLING VALUES('11','2023APRIL15','15.00','CASH','150000','NO',' SURGERY','02');
INSERT INTO BILLING VALUES('12','2023APRIL19','14.00','CARD','10000','YES','1 DAY HOSPITALIZED','04');
INSERT INTO BILLING VALUES('13','2023APRIL20','13.00','CARD','40000','YES','4 DAYS HOSPITALIZED','05');
INSERT INTO BILLING VALUES('14','2023APRIL21','15.00','CASH','20000','NO','2 DAYS HOSPITALIZED','06');
INSERT INTO BILLING VALUES('15','2023APRIL22','12.00','CARD','125000','NO','SUGERY','07');
INSERT INTO BILLING VALUES('16','2023APRIL25','19.00','CASH','150000','YES','15 DAYS HOSPITALIZED','08');
INSERT INTO BILLING VALUES('17','2023APRIL26','18.00','CARD','10000','NO','1DAY HOSPITALIZED','09');
INSERT INTO BILLING VALUES('18','2023APRIL26','18.30','CASH','10000','YES','1 DAY HOSPITALIZED','10');
INSERT INTO BILLING VALUES('19','2023APRIL27','19.00','CARD','20000','YES','2 DAY HOSPITALIZED','03');
SELECT *FROM BILLING



-------------01 UPDATE QUARY-------------
UPDATE PATIENT
SET ADDRESS = 'MAIN STREET SAMMANTHURAI'
WHERE PATIENT_ID = 1;

-------------02 DELETE QUARY-------------
DELETE FROM BILLING
WHERE BILLING_ID = 1;
---------------------RETRIVING QUARIES---------------
----01------
SELECT P.*
FROM PATIENT p
JOIN APPOINMENT A ON P.PATIENT_ID= A.PATIENT_ID
WHERE A.APPOINMENTDATE = '2023-05-02';

-----02-----
SELECT DOCTOR_ID, COUNT(*) as TOTAL_APPOINMENTS
FROM APPOINMENT
GROUP BY DOCTOR_ID

-----03------
SELECT *FROM APPOINMENT
WHERE DOCTOR
GROUP BY DOCTOR_ID
HAVING COUNT(APPOINMENTDATE) > 5

-----04------
SELECT A.APPOINMENT_ID, A.APPOINMENTMETHOD, D.DOCTOR_FIRSTNAME, D.SPECIALITY,D.PHONENUMBER 
FROM APPOINMENT A 
JOIN DOCTOR D ON A.DOCTOR_ID = D.DOCTOR_ID
WHERE A.PATIENT_ID = 1;

----05-------
SELECT * FROM PATIENT
WHERE PATIENT_ID NOT IN (SELECT PATIENT_ID FROM APPOINMENT)

-----06-------
SELECT GENDER, COUNT(*) as NUM_APPOINMENT
FROM PATIENT
GROUP BY GENDER;

-----07-------
SELECT *
FROM DOCTOR
WHERE DOCTOR_ID NOT IN (SELECT DOCTOR_ID FROM APPOINMENT);

-----08------
SELECT *
FROM PATIENT 
WHERE NOT EXISTS( 
SELECT DOCTOR_ID
FROM DOCTOR D
WHERE  NOT EXISTS(
SELECT APPOINMENT_ID
FROM APPOINMENT
WHERE DOCTOR_ID = DOCTOR_ID AND PATIENT_ID = PATIENT_ID
));    

-----------09-------
SELECT * FROM APPOINMENT
WHERE APPOINMENTDATE BETWEEN 0 AND 5

--------10---------
SELECT LABTEST, COUNT(*) as TOTAL_APPOINMENT
FROM MEDICALHISTORY 
GROUP BY LABTEST;

